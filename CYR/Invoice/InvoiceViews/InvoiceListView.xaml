<UserControl
  x:Class="CYR.Invoice.InvoiceViews.InvoiceListView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:customddm="clr-namespace:DropDownMenuControl;assembly=DropDownMenuControl"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:irdt="clr-namespace:CYR.Invoice.Resources.DataTemplates"
  xmlns:local="clr-namespace:CYR.Invoice.InvoiceViews"
  xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:vm="clr-namespace:CYR.Invoice.InvoiceViewModels"
  d:DataContext="{d:DesignInstance Type=vm:InvoiceListViewModel,
                                   IsDesignTimeCreatable=False}"
  d:DesignHeight="450"
  d:DesignWidth="800"
  mc:Ignorable="d">
  <UserControl.Resources>
    <irdt:InvoiceListViewInvoiceStateTemplateSelector
      x:Key="StateTemplateSelector"
      ClosedTemplate="{StaticResource ClosedTemplate}"
      OpenTemplate="{StaticResource OpenTemplate}" />
  </UserControl.Resources>
  <Grid Background="White">
    <Grid Margin="10" Background="Transparent">
      <Grid.RowDefinitions>
        <RowDefinition Height="auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>

      <Grid Grid.Row="0" Margin="0,15,0,10">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="auto" />
        </Grid.ColumnDefinitions>
        <Label
          Grid.Column="0"
          Content="Rechnungen"
          FontSize="24"
          FontWeight="DemiBold" />

        <StackPanel
          Grid.Column="1"
          HorizontalAlignment="Right"
          Orientation="Horizontal">
          <Border
            x:Name="bDDM"
            BorderBrush="LightGray"
            BorderThickness="1"
            CornerRadius="5">
            <customddm:DropDownMenu DropDownTextPart="Status auswählen" FontSize="12">
              <customddm:DropDownMenu.Content>
                <Border BorderBrush="LightGray" BorderThickness="1">
                  <StackPanel Background="White">
                    <Button
                      Width="{Binding Width, ElementName=bDDM}"
                      Content="Open"
                      Style="{StaticResource MaterialDesignFlatButton}" />
                    <Separator Background="LightGray" />
                    <Button
                      Width="{Binding Width, ElementName=bDDM}"
                      Command="{Binding SetInvoiceStateClosedCommand}"
                      Content="Closed"
                      Style="{StaticResource MaterialDesignFlatButton}" />
                  </StackPanel>
                </Border>
              </customddm:DropDownMenu.Content>
            </customddm:DropDownMenu>
          </Border>
          <Button
            Margin="10,0,10,0"
            BorderBrush="LightGray"
            BorderThickness="1"
            Style="{StaticResource MaterialDesignFlatButton}">
            <Button.Content>
              <materialDesign:PackIcon Kind="DotsHorizontal" />
            </Button.Content>
          </Button>
          <StackPanel VerticalAlignment="Center">
            <Button>
              <Button.Content>
                <StackPanel Orientation="Horizontal">
                  <materialDesign:PackIcon
                    Margin="0,0,5,0"
                    VerticalAlignment="Center"
                    Kind="PlusCircleOutline" />
                  <TextBlock VerticalAlignment="Top" Text="Rechnung" />
                </StackPanel>
              </Button.Content>
            </Button>
          </StackPanel>
        </StackPanel>
      </Grid>
      <Border
        Grid.Row="1"
        BorderBrush="LightGray"
        BorderThickness="1"
        CornerRadius="5">
        <DataGrid
          x:Name="dgInvoices"
          AutoGenerateColumns="False"
          Background="Transparent"
          BorderBrush="LightGray"
          CanUserAddRows="False"
          IsReadOnly="True"
          ItemsSource="{Binding Invoices}">
          <DataGrid.Columns>
            <DataGridTemplateColumn Header="Rechnung">
              <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                  <StackPanel Orientation="Horizontal">
                    <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" />
                    <TextBlock Text=" - R " />
                    <TextBlock Text="{Binding InvoiceNumber}" />
                  </StackPanel>
                </DataTemplate>
              </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
            <DataGridTextColumn Binding="{Binding Customer.ClientNumber}" Header="Kundenummer" />
            <DataGridTextColumn Binding="{Binding Customer.Name}" Header="Kundenname" />
            <DataGridTextColumn Binding="{Binding NetAmount}" Header="Netto" />
            <DataGridTextColumn Binding="{Binding GrossAmount}" Header="Brutto" />
            <DataGridTextColumn
              Width="250"
              Binding="{Binding Subject}"
              Header="Betreff" />
            <DataGridTextColumn Binding="{Binding ObjectNumber}" Header="Objektnummer" />
            <DataGridTemplateColumn>
              <DataGridTemplateColumn.CellTemplateSelector>
                <StaticResource ResourceKey="StateTemplateSelector" />
              </DataGridTemplateColumn.CellTemplateSelector>
            </DataGridTemplateColumn>
          </DataGrid.Columns>
          <DataGrid.InputBindings>
            <MouseBinding
              Command="{Binding SelectInvoiceCommand}"
              CommandParameter="{Binding SelectedItem, ElementName=dgInvoices}"
              MouseAction="LeftDoubleClick" />
          </DataGrid.InputBindings>
        </DataGrid>
      </Border>
    </Grid>
  </Grid>
</UserControl>
